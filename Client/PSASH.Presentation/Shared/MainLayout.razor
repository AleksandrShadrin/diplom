@using PSASH.Core.ValueObjects;
@using PSASH.Infrastructure.Services.FileBased;
@using PSASH.Presentation.Components;
@using PSASH.Presentation.Models;
@inherits LayoutComponentBase

@inject DialogService DialogService
@inject IFileBasedMonoDatasetService filebasedMonoDatasetService
@inject NavigationManager navManger

<PageTitle>PSASH.Presentation</PageTitle>
<RadzenDialog />
<RadzenNotification />

<RadzenLayout>
    <RadzenHeader>
        <RadzenStack AlignItems="AlignItems.Center" Orientation="Orientation.Horizontal">
            <RadzenSidebarToggle Click="@(() => expandSidebar = !expandSidebar)" />
            <RadzenLabel Text="Home"></RadzenLabel>
        </RadzenStack>
    </RadzenHeader>
    <RadzenSidebar class="h-100 text-center" @bind-Expanded="expandSidebar">
        <TimeSeriesList @bind-TimeSeries="timeSeries" @bind-Selected="selected" @bind-Selected:after="GoToTimeSeriesPage">
        </TimeSeriesList>
    </RadzenSidebar>
    <main>
        <article class="content px-4">
            @Body
        </article>
    </main>
</RadzenLayout>


@code {
    private bool expandSidebar = true;

    private TimeSeriesDto selected = default;

    private List<TimeSeriesDto> timeSeries = new();
    private Task GoToTimeSeriesPage()
    {
        navManger.NavigateTo($"/timeseries/{selected.Name.ToRouteString()}");

        return Task.CompletedTask;
    }
}